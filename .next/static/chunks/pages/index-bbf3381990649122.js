(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2701:(e,t,n)=>{"use strict";let r,o,s,a;n.r(t),n.d(t,{default:()=>_});var i=n(7876),c=n(4232);let u=(e,t)=>t.some(t=>e instanceof t),d=new WeakMap,l=new WeakMap,f=new WeakMap,p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return h(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{t(h(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",s)}),f.set(t,e),t}if(l.has(e))return l.get(e);let t=function(e){if("function"==typeof e)return(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(w(this),t),h(this.request)}:function(...t){return h(e.apply(w(this),t))};return(e instanceof IDBTransaction&&function(e){if(d.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});d.set(e,t)}(e),u(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,p):e}(e);return t!==e&&(l.set(e,t),f.set(t,e)),t}let w=e=>f.get(e),y=["get","getKey","getAll","getAllKeys","count"],I=["put","add","delete","clear"],D=new Map;function v(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(D.get(t))return D.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,o=I.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||y.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,o?"readwrite":"readonly"),a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),o&&s.done]))[0]};return D.set(t,s),s}p={...s=p,get:(e,t,n)=>v(e,t)||s.get(e,t,n),has:(e,t)=>!!v(e,t)||s.has(e,t)};let m=["continue","continuePrimaryKey","advance"],g={},B=new WeakMap,E=new WeakMap,b={get(e,t){if(!m.includes(t))return e[t];let n=g[t];return n||(n=g[t]=function(...e){B.set(this,E.get(this)[t](...e))}),n}};async function*x(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,b);for(E.set(n,t),f.set(n,w(t));t;)yield n,t=await (B.get(n)||t.continue()),B.delete(n)}function k(e,t){return t===Symbol.asyncIterator&&u(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&u(e,[IDBIndex,IDBObjectStore])}p={...a=p,get:(e,t,n)=>k(e,t)?x:a.get(e,t,n),has:(e,t)=>k(e,t)||a.has(e,t)};let j=async()=>(function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:s}={}){let a=indexedDB.open(e,1),i=h(a);return r&&a.addEventListener("upgradeneeded",e=>{r(h(a.result),e.oldVersion,e.newVersion,h(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),i.then(e=>{s&&e.addEventListener("close",()=>s()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i})("kalnaf-db",0,{upgrade(e){e.objectStoreNames.contains("products")||e.createObjectStore("products",{keyPath:"id",autoIncrement:!0})}}),L=async e=>{let t=await j();await t.put("products",e)},P=async()=>(await j()).getAll("products");function _(){let[e,t]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{t(await P())})()},[]);let n=async()=>{await L({name:"Produk A",price:1e4}),t(await P())};return(0,i.jsxs)("div",{style:{padding:"2rem"},children:[(0,i.jsx)("h1",{children:"Kalnaf PWA + IndexedDB"}),(0,i.jsx)("button",{onClick:n,children:"Tambah Produk"}),(0,i.jsx)("ul",{children:e.map(e=>(0,i.jsxs)("li",{children:[e.name," - ",e.price]},e.id))})]})}},6760:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2701)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);